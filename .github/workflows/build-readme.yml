name: 'Build README generator'

on:
  push:
    branches:
      - 'development'
      - 'main'
    paths:
      - 'readme/**/*'
      - '.github/workflows/build-readme.yml'
      - '.github/workflows/update-readme.yml'
  schedule:
    - cron: '0 9 1 * *'
  workflow_dispatch:

jobs:
  build:
    runs-on: 'ubuntu-latest'
    steps:
      - name: 'ğŸ’¾ Checkout development branch'
        uses: 'actions/checkout@master'
        with:
          ref: 'development'
          path: 'development'

      - name: 'ğŸ§° Setup Node.js'
        uses: 'actions/setup-node@v2'
        with:
          node-version: "16.x"

      - name: 'ğŸ§° Install dependencies'
        run: 'cd $GITHUB_WORKSPACE/development/readme && yarn install'

      - name: 'ğŸ—ï¸ Build generator'
        run: 'cd $GITHUB_WORKSPACE/development/readme && yarn run assemble:release'

      - name: 'ğŸ“¤ Upload generator build'
        uses: 'actions/upload-artifact@v2'
        with:
          name: 'readme-generator'
          path: '${{ github.workspace }}/development/readme/build/release/'